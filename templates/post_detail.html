{% extends "base.html" %}

{% block content %}

<template x-for="blog in blogs" :key="blog.id">
    <div :id="'blog-' + blog.id" x-data="{ showComments: false, newComment: { author: '', content: '' } }" class="hidden">
            <a href="#" class="text-secondary hover:text-accent mb-4 inline-block">&larr; Back to Blog List</a>
            <h1 x-text="blog.title" class="text-3xl font-bold mb-4"></h1>
            <img :src="blog.image" :alt="blog.title" class="w-full h-64 object-cover rounded-lg mb-4">
            <p x-text="blog.content" class="text-gray-700 dark:text-gray-300 leading-relaxed mb-6"></p>
            
            <div class="flex items-center mb-6">
                <button @click="blog.likes++" class="flex items-center mr-2 px-4 py-2 bg-secondary hover:bg-accent text-white rounded">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z" clip-rule="evenodd" />
                    </svg>
                    Like
                </button>
                <span x-text="blog.likes + ' likes'" class="text-gray-600 dark:text-gray-300"></span>
            </div>

            <h2 class="text-2xl font-bold mb-4">Comments</h2>
            <button @click="showComments = !showComments" 
                    x-text="showComments ? 'Hide Comments' : 'Show Comments'" 
                    class="mb-4 px-4 py-2 bg-primary text-white rounded hover:bg-opacity-80">
            </button>

            <div x-show="showComments">
                <template x-for="comment in blog.comments" :key="comment.id">
                    <div class="mb-4 p-4 bg-gray-100 dark:bg-gray-700 rounded-lg">
                        <p x-text="comment.author" class="font-semibold"></p>
                        <p x-text="comment.content" class="text-gray-600 dark:text-gray-300"></p>
                        <p x-text="new Date(comment.createdAt).toLocaleDateString()" class="text-sm text-gray-500 dark:text-gray-400 mt-2"></p>
                    </div>
                </template>

                <form @submit.prevent="blog.comments.push({id: blog.comments.length + 1, ...newComment, createdAt: new Date().toISOString()}); newComment = { author: '', content: '' }" class="mt-6">
                    <h3 class="text-xl font-bold mb-4">Add a Comment</h3>
                    <input type="text" x-model="newComment.author" placeholder="Your Name" required
                            class="w-full p-2 mb-2 border border-gray-300 rounded dark:bg-gray-700 dark:border-gray-600">
                    <textarea x-model="newComment.content" placeholder="Your Comment" required
                                class="w-full p-2 mb-2 border border-gray-300 rounded dark:bg-gray-700 dark:border-gray-600"></textarea>
                    <button type="submit" class="px-4 py-2 bg-secondary hover:bg-accent text-white rounded">Submit Comment</button>
                </form>
            </div>
        </div>
    </div>
</template>

{% endblock %}